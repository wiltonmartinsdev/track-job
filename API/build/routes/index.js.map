{"version":3,"sources":["../../src/routes/index.ts","../../src/routes/job-routes.ts","../../src/controllers/job-controller.ts","../../src/database/knex.ts","../../knexfile.ts","../../src/utils/AppError.ts"],"sourcesContent":["import { Router } from \"express\";\n\nimport { jobRoutes } from \"./job-routes\";\n\nexport const routes = Router();\n\nroutes.use(\"/\", jobRoutes);\n","import { Router } from \"express\";\n\nimport JobController from \"../controllers/job-controller\";\n\nexport const jobRoutes = Router();\nconst jobController = new JobController();\n\njobRoutes.get(\"/\", jobController.index);\njobRoutes.post(\"/\", jobController.create);\njobRoutes.put(\"/:id\", jobController.update);\njobRoutes.delete(\"/:id\", jobController.delete);\n","import { NextFunction, Request, Response } from \"express\";\nimport z from \"zod\";\n\nimport { knex } from \"../database/knex\";\nimport AppError from \"../utils/AppError\";\n\nexport default class JobController {\n\tasync index(request: Request, response: Response, next: NextFunction) {\n\t\ttry {\n\t\t\tconst { company_name } = request.query;\n\t\t\tconst jobs = await knex<jobRepository>(\"jobs\")\n\t\t\t\t.select()\n\t\t\t\t.whereLike(\"company_name\", `%${company_name ?? \"\"}%`)\n\t\t\t\t.orderBy(\"created_at\", \"desc\");\n\n\t\t\tresponse.json(jobs);\n\t\t} catch (error) {\n\t\t\tnext(error);\n\t\t}\n\t}\n\n\tasync create(request: Request, response: Response, next: NextFunction) {\n\t\ttry {\n\t\t\tconst bodySchema = z.object({\n\t\t\t\tcompany_name: z.string().trim().min(4),\n\t\t\t\tposition: z.string().trim().min(13),\n\t\t\t\tseniority_level: z.string().trim().min(5),\n\t\t\t\tvacancy_modality: z.string().trim().min(6),\n\t\t\t\twork_regime: z.string().trim().min(2),\n\t\t\t\tplace: z.string().trim().min(4),\n\t\t\t\tstatus: z.string().trim().min(7),\n\t\t\t});\n\n\t\t\tconst {\n\t\t\t\tcompany_name,\n\t\t\t\tposition,\n\t\t\t\tseniority_level,\n\t\t\t\tvacancy_modality,\n\t\t\t\twork_regime,\n\t\t\t\tplace,\n\t\t\t\tstatus,\n\t\t\t} = bodySchema.parse(request.body);\n\n\t\t\tawait knex<jobRepository>(\"jobs\").insert({\n\t\t\t\tcompany_name,\n\t\t\t\tposition,\n\t\t\t\tseniority_level,\n\t\t\t\tvacancy_modality,\n\t\t\t\twork_regime,\n\t\t\t\tplace,\n\t\t\t\tstatus,\n\t\t\t});\n\n\t\t\tresponse.status(201).json({\n\t\t\t\tmessage: \"Job created successfully\",\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tnext(error);\n\t\t}\n\t}\n\n\tasync update(request: Request, response: Response, next: NextFunction) {\n\t\ttry {\n\t\t\tconst id = z\n\t\t\t\t.string()\n\t\t\t\t.transform((value) => Number(value))\n\t\t\t\t.refine((value) => !isNaN(value), {\n\t\t\t\t\tmessage: \"Id must be a number\",\n\t\t\t\t})\n\t\t\t\t.parse(request.params.id);\n\n\t\t\tconst {\n\t\t\t\tcompany_name,\n\t\t\t\tposition,\n\t\t\t\tseniority_level,\n\t\t\t\tvacancy_modality,\n\t\t\t\twork_regime,\n\t\t\t\tplace,\n\t\t\t\tstatus,\n\t\t\t} = z\n\t\t\t\t.object({\n\t\t\t\t\tcompany_name: z.string().trim().min(4),\n\t\t\t\t\tposition: z.string().trim().min(13),\n\t\t\t\t\tseniority_level: z.string().trim().min(5),\n\t\t\t\t\tvacancy_modality: z.string().trim().min(6),\n\t\t\t\t\twork_regime: z.string().trim().min(2),\n\t\t\t\t\tplace: z.string().trim().min(4),\n\t\t\t\t\tstatus: z.string().trim().min(7),\n\t\t\t\t})\n\t\t\t\t.parse(request.body);\n\n\t\t\tconst job = await knex<jobRepository>(\"jobs\")\n\t\t\t\t.select()\n\t\t\t\t.where({ id })\n\t\t\t\t.first();\n\n\t\t\tif (!job) {\n\t\t\t\tthrow new AppError(\"Job not found\", 404);\n\t\t\t}\n\n\t\t\tawait knex<jobRepository>(\"jobs\")\n\t\t\t\t.update({\n\t\t\t\t\tcompany_name,\n\t\t\t\t\tposition,\n\t\t\t\t\tseniority_level,\n\t\t\t\t\tvacancy_modality,\n\t\t\t\t\twork_regime,\n\t\t\t\t\tplace,\n\t\t\t\t\tstatus,\n\t\t\t\t\tupdated_at: knex.fn.now(),\n\t\t\t\t})\n\t\t\t\t.where({ id });\n\n\t\t\tresponse.json({ message: \"Job updated successfully\" });\n\t\t} catch (error) {\n\t\t\tnext(error);\n\t\t}\n\t}\n\n\tasync delete(request: Request, response: Response, next: NextFunction) {\n\t\ttry {\n\t\t\tconst id = z\n\t\t\t\t.string()\n\t\t\t\t.transform((value) => Number(value))\n\t\t\t\t.refine((value) => !isNaN(value), {\n\t\t\t\t\tmessage: \"Id must be a number\",\n\t\t\t\t})\n\t\t\t\t.parse(request.params.id);\n\n\t\t\tconst job = await knex<jobRepository>(\"jobs\")\n\t\t\t\t.select()\n\t\t\t\t.where({ id })\n\t\t\t\t.first();\n\n\t\t\tif (!job) {\n\t\t\t\tthrow new AppError(\"Job not found\", 404);\n\t\t\t}\n\n\t\t\tawait knex<jobRepository>(\"jobs\").delete().where({ id });\n\n\t\t\tresponse.json({ message: \"Job deleted successfully\" });\n\t\t} catch (error) {\n\t\t\tnext(error);\n\t\t}\n\t}\n}\n","import { knex as knexConfig } from \"knex\";\n\nimport config from \"../../knexfile\";\n\nexport const knex = knexConfig(config);\n","export default {\n    client: 'sqlite3',\n    connection: {\n        filename: \"./src/database/database.db\"\n    },\n    useNullAsDefault: true,\n\n    migrations: {\n        extension: 'ts',\n        directory: './src/database/migrations'\n    }\n}","export default class AppError {\n    message: string;\n    statusCode: number;     \n    constructor(message: string, statusCode = 400) {\n        this.message = message;\n        this.statusCode = statusCode;\n        \n    }\n}"],"mappings":"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","names":["import_express","knexConfig","z"]}